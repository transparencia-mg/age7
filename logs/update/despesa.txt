Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 700, in urlopen
    self._prepare_proxy(conn)
  File "/usr/local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 994, in _prepare_proxy
    conn.connect()
  File "/usr/local/lib/python3.9/site-packages/urllib3/connection.py", line 369, in connect
    self._tunnel()
  File "/usr/local/lib/python3.9/http/client.py", line 926, in _tunnel
    (version, code, message) = response._read_status()
  File "/usr/local/lib/python3.9/http/client.py", line 281, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.9/socket.py", line 704, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/usr/local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 785, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.9/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='dados.mg.gov.br', port=443): Max retries exceeded with url: /dataset/eb709e1d-c19e-4371-b1ea-436920cf537a/resource/67bfcc88-66e4-4a65-b46e-4fba788c4496/download/datapackage.json (Caused by ProxyError('Cannot connect to proxy.', ConnectionResetError(104, 'Connection reset by peer')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/frictionless/metadata.py", line 242, in metadata_extract
    response = http_session.get(descriptor)
  File "/usr/local/lib/python3.9/site-packages/requests/sessions.py", line 600, in get
    return self.request("GET", url, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python3.9/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/requests/adapters.py", line 559, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPSConnectionPool(host='dados.mg.gov.br', port=443): Max retries exceeded with url: /dataset/eb709e1d-c19e-4371-b1ea-436920cf537a/resource/67bfcc88-66e4-4a65-b46e-4fba788c4496/download/datapackage.json (Caused by ProxyError('Cannot connect to proxy.', ConnectionResetError(104, 'Connection reset by peer')))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/bin/dpckan", line 8, in <module>
    sys.exit(cli())
  File "/usr/local/lib/python3.9/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/click/core.py", line 1055, in main
    rv = self.invoke(ctx)
  File "/usr/local/lib/python3.9/site-packages/click/core.py", line 1657, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/local/lib/python3.9/site-packages/click/core.py", line 1657, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/local/lib/python3.9/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/local/lib/python3.9/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/click/decorators.py", line 26, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dpckan/update_dataset.py", line 21, in update_cli
    update(
  File "/usr/local/lib/python3.9/site-packages/dpckan/update_dataset.py", line 13, in update
    dataset_update(ckan_instance, package, datastore, exit_code)
  File "/usr/local/lib/python3.9/site-packages/dpckan/functions.py", line 136, in dataset_update
    different_resources = dataset_diff(ckan_instance, datapackage)
  File "/usr/local/lib/python3.9/site-packages/dpckan/functions.py", line 167, in dataset_diff
    resource_diff = get_resource_diff(ckan_instance, datapackage, resource_name, resource_id)
  File "/usr/local/lib/python3.9/site-packages/dpckan/functions.py", line 195, in get_resource_diff
    resource_diff['metadada_diff'] = is_resource_metadata_diff(ckan_instance,
  File "/usr/local/lib/python3.9/site-packages/dpckan/functions.py", line 213, in is_resource_metadata_diff
    remote_dataset_metadata = get_remote_dataset_metadata(ckan_instance, datapackage.name)
  File "/usr/local/lib/python3.9/site-packages/dpckan/functions.py", line 223, in get_remote_dataset_metadata
    remote_dataset_metadata = Package(ckan_datapackage_resource['url'])
  File "/usr/local/lib/python3.9/site-packages/frictionless/package/package.py", line 195, in __init__
    super().__init__(descriptor)
  File "/usr/local/lib/python3.9/site-packages/frictionless/metadata.py", line 46, in __init__
    metadata = self.metadata_extract(descriptor)
  File "/usr/local/lib/python3.9/site-packages/frictionless/metadata.py", line 257, in metadata_extract
    raise FrictionlessException(self.__Error(note=note)) from exception
frictionless.exception.FrictionlessException: [package-error] The data package has an error: cannot extract metadata "https://dados.mg.gov.br/dataset/eb709e1d-c19e-4371-b1ea-436920cf537a/resource/67bfcc88-66e4-4a65-b46e-4fba788c4496/download/datapackage.json" because "HTTPSConnectionPool(host='dados.mg.gov.br', port=443): Max retries exceeded with url: /dataset/eb709e1d-c19e-4371-b1ea-436920cf537a/resource/67bfcc88-66e4-4a65-b46e-4fba788c4496/download/datapackage.json (Caused by ProxyError('Cannot connect to proxy.', ConnectionResetError(104, 'Connection reset by peer')))"
